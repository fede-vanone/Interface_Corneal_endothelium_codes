% for the output corresponding to x=l, see its correlation with each of the 
% 11 parameters 
clear all
close all

load('X.mat');
load('Yfull.mat','Y');

%%
% check sampling of parameter k vs parameter m
k=5;
m=9;

% fourth index in X is number of resamplings
figure
plot(X(:,k,k,1),X(:,m,k,1),'o')
hold on 
plot(X(:,k,k,2),X(:,m,k,2),'o')
plot(X(:,k,k,3),X(:,m,k,3),'o')
xlabel(efast_var(k))
ylabel(efast_var(m))

%%
for k=1:11 % number of parameters (permeabilities)
l=15; % which output we are looking at (from 1 to 17) among the following:
% 1 'cc0',2 'cc1',3 'cc2',4 'cc3',5 'vc',6 'va',7 'xx',8 'J0tot',9 'J1tot',10 'J2tot',...
%    11 'J3tot', 12'Jtj',13 'J1tj',14 'J2tj',15 'J3tj',16 'overall water
%    flux', 17 'wf hexagon'

% for 3 sampling curves
ind1=isnan(Y(:,1,k,1));
ind2=isnan(Y(:,1,k,2));
ind3=isnan(Y(:,1,k,3));

% fit with a 2nd order poly X,Y of the 3 resamplings
p = polyfit([X(~ind1,k,k,1);X(~ind2,k,k,2);X(~ind3,k,k,3)],[Y(~ind1,l,k,1);Y(~ind2,l,k,2);Y(~ind3,l,k,3)],2);

figure
plot(X(:,k,k,1),Y(:,l,k,1),'o')
hold on 
plot(X(:,k,k,2),Y(:,l,k,2),'o') 
plot(X(:,k,k,3),Y(:,l,k,3),'o') 
% plot the polynomial
plot(sort(X(:,k,k,1)),polyval(p,sort(X(:,k,k,1))),'k-') 
set(gca, 'FontSize', 16)
xlabel( efast_var(k)+ " (m s$^{-1}$)", 'FontSize',16,'Interpreter','LaTex')
ylabel(y_var_label(l),'FontSize',16,'Interpreter','LaTex')
end


%% scatter plot TEP vs water flux bar(Q)
% 
figure('WindowState','maximized');
set(groot,'defaultAxesTickLabelInterpreter','latex');  
set(groot,'defaultLegendInterpreter','latex');
for k=1:11 % parameters
    for n=1:3 % curves
        plot(Y(:,6,k,n)*R*T/F,Y(:,16,k,n),'ko') % tep vs water flux
        hold on
    end 
end 

p = polyfit([Y(:,6,1,1);Y(:,6,1,2);Y(:,6,1,3);...
    Y(:,6,2,1);Y(:,6,2,2);Y(:,6,2,3);...
    Y(:,6,3,1);Y(:,6,3,2);Y(:,6,3,3); ...
    Y(:,6,4,1);Y(:,6,4,2);Y(:,6,4,3);...
    Y(:,6,5,1);Y(:,6,5,2);Y(:,6,5,3);...
    Y(:,6,6,1);Y(:,6,6,2);Y(:,6,6,3);...
    Y(:,6,7,1);Y(:,6,7,2);Y(:,6,7,3);...
    Y(:,6,8,1);Y(:,6,8,2);Y(:,6,8,3); ...
    Y(:,6,9,1);Y(:,6,9,2);Y(:,6,9,3); ...
    Y(:,6,10,1);Y(:,6,10,2);Y(:,6,10,3);...
    Y(:,6,11,1);Y(:,6,11,2);Y(:,6,11,3)]*R*T/F,...
    [Y(:,16,1,1);Y(:,16,1,2);Y(:,16,1,3);...
    Y(:,16,2,1);Y(:,16,2,2);Y(:,16,2,3); ...
    Y(:,16,3,1);Y(:,16,3,2);Y(:,16,3,3);...
    Y(:,16,4,1);Y(:,16,4,2);Y(:,16,4,3);...
    Y(:,16,5,1);Y(:,16,5,2);Y(:,16,5,3);...
    Y(:,16,6,1);Y(:,16,6,2);Y(:,16,6,3);...
    Y(:,16,7,1);Y(:,16,7,2);Y(:,16,7,3);...
    Y(:,16,8,1);Y(:,16,8,2);Y(:,16,8,3); ...
    Y(:,16,9,1);Y(:,16,9,2);Y(:,16,9,3); ...
    Y(:,16,10,1);Y(:,16,10,2);Y(:,16,10,3);...
    Y(:,16,11,1);Y(:,16,11,2);Y(:,16,11,3)],2);
plot(sort(Y(:,6,1,1)*R*T/F),polyval(p,sort(Y(:,6,1,1)*R*T/F)),'r-','LineWidth',3)
xlabel('$V^a$ (V)','Interpreter','latex')
ylabel('$\bar{Q}$ (m/s)','Interpreter','latex')
set(gca,'Linewidth',2,'Fontsize',24)
% exportgraphics(gcf,'wf_vs_va.png','Resolution',200)
% print(gcf, 'wf_vs_va.png', '-dpng', '-r200');


%% scatter plot tj current vs water flux bar(Q)

figure('WindowState','maximized');
set(groot,'defaultAxesTickLabelInterpreter','latex');  
set(groot,'defaultLegendInterpreter','latex');
for k=1:11 % parameters
    for n=1:3 % curves
        plot(F*1e2*(Y(:,12,k,n)+Y(:,13,k,n)-Y(:,14,k,n)-Y(:,15,k,n)),Y(:,16,k,n)*3.6e9,'ko') % tep vs water flux
        hold on
    end 
end 

p = polyfit([Y(:,12,1,1)+Y(:,13,1,1)-Y(:,14,1,1)-Y(:,15,1,1);Y(:,12,1,2)+Y(:,13,1,2)-Y(:,14,1,2)-Y(:,15,1,2);Y(:,12,1,3)+Y(:,13,1,3)-Y(:,14,1,3)-Y(:,15,1,3);...
    Y(:,12,2,1)+Y(:,13,2,1)-Y(:,14,2,1)-Y(:,15,2,1);Y(:,12,2,2)+Y(:,13,2,2)-Y(:,14,2,2)-Y(:,15,2,2);Y(:,12,2,3)+Y(:,13,2,3)-Y(:,14,2,3)-Y(:,15,2,3);...
    Y(:,12,3,1)+Y(:,13,3,1)-Y(:,14,3,1)-Y(:,15,3,1);Y(:,12,3,2)+Y(:,13,3,2)-Y(:,14,3,2)-Y(:,15,3,2);Y(:,12,3,3)+Y(:,13,3,3)-Y(:,14,3,3)-Y(:,15,3,3); ...
    Y(:,12,4,1)+Y(:,13,4,1)-Y(:,14,4,1)-Y(:,15,4,1);Y(:,12,4,2)+Y(:,13,4,2)-Y(:,14,4,2)-Y(:,15,4,2);Y(:,12,4,3)+Y(:,13,4,3)-Y(:,14,4,3)-Y(:,15,4,3);...
    Y(:,12,5,1)+Y(:,13,5,1)-Y(:,14,5,1)-Y(:,15,5,1);Y(:,12,5,2)+Y(:,13,5,2)-Y(:,14,5,2)-Y(:,15,5,2);Y(:,12,5,3)+Y(:,13,5,3)-Y(:,14,5,3)-Y(:,15,5,3);...
    Y(:,12,6,1)+Y(:,13,6,1)-Y(:,14,6,1)-Y(:,15,6,1);Y(:,12,6,2)+Y(:,13,6,2)-Y(:,14,6,2)-Y(:,15,6,2);Y(:,12,6,3)+Y(:,13,6,3)-Y(:,14,6,3)-Y(:,15,6,3);...
    Y(:,12,7,1)+Y(:,13,7,1)-Y(:,14,7,1)-Y(:,15,7,1);Y(:,12,7,2)+Y(:,13,7,2)-Y(:,14,7,2)-Y(:,15,7,2);Y(:,12,7,3)+Y(:,13,7,3)-Y(:,14,7,3)-Y(:,15,7,3);...
    Y(:,12,8,1)+Y(:,13,8,1)-Y(:,14,8,1)-Y(:,15,8,1);Y(:,12,8,2)+Y(:,13,8,2)-Y(:,14,8,2)-Y(:,15,8,2);Y(:,12,8,3)+Y(:,13,8,3)-Y(:,14,8,3)-Y(:,15,8,3); ...
    Y(:,12,9,1)+Y(:,13,9,1)-Y(:,14,9,1)-Y(:,15,9,1);Y(:,12,9,2)+Y(:,13,9,2)-Y(:,14,9,2)-Y(:,15,9,2);Y(:,12,9,3)+Y(:,13,9,3)-Y(:,14,9,3)-Y(:,15,9,3); ...
    Y(:,12,10,1)+Y(:,13,10,1)-Y(:,14,10,1)-Y(:,15,10,1);Y(:,12,10,2)+Y(:,13,10,2)-Y(:,14,10,2)-Y(:,15,10,2);Y(:,12,10,3)+Y(:,13,10,3)-Y(:,14,10,3)-Y(:,15,10,3);...
    Y(:,12,11,1)+Y(:,13,11,1)-Y(:,14,11,1)-Y(:,15,11,1);Y(:,12,11,2)+Y(:,13,11,2)-Y(:,14,11,2)-Y(:,15,11,2);Y(:,12,11,3)+Y(:,13,11,3)-Y(:,14,11,3)-Y(:,15,11,3)]*F*1e2,...
    [Y(:,16,1,1);Y(:,16,1,2);Y(:,16,1,3);...
    Y(:,16,2,1);Y(:,16,2,2);Y(:,16,2,3); ...
    Y(:,16,3,1);Y(:,16,3,2);Y(:,16,3,3);...
    Y(:,16,4,1);Y(:,16,4,2);Y(:,16,4,3);...
    Y(:,16,5,1);Y(:,16,5,2);Y(:,16,5,3);...
    Y(:,16,6,1);Y(:,16,6,2);Y(:,16,6,3);...
    Y(:,16,7,1);Y(:,16,7,2);Y(:,16,7,3);...
    Y(:,16,8,1);Y(:,16,8,2);Y(:,16,8,3); ...
    Y(:,16,9,1);Y(:,16,9,2);Y(:,16,9,3); ...
    Y(:,16,10,1);Y(:,16,10,2);Y(:,16,10,3);...
    Y(:,16,11,1);Y(:,16,11,2);Y(:,16,11,3)]*3.6e9,2);
plot(sort((Y(:,12,1,1)+Y(:,13,1,1)-Y(:,14,1,1)-Y(:,15,1,1))*F*1e2),polyval(p,sort((Y(:,12,1,1)+Y(:,13,1,1)-Y(:,14,1,1)-Y(:,15,1,1))*F*1e2)),'r-','LineWidth',3)
xlabel('$I_{OC}$ ($\mu$A/cm$^2$)','Interpreter','latex')
ylabel('$\bar{Q}$ ($\mu$m/h)','Interpreter','latex')
set(gca,'Linewidth',2,'Fontsize',24)
% exportgraphics(gcf,'wf_vs_va.png','Resolution',200)
% print(gcf, 'wf_vs_current.png', '-dpng', '-r200');



%% scatter plot tj current vs tep

figure('WindowState','maximized');
set(groot,'defaultAxesTickLabelInterpreter','latex');  
set(groot,'defaultLegendInterpreter','latex');
for k=1:11 % parameters
    for n=1:3 % curves
        plot((Y(:,12,k,n)+Y(:,13,k,n)-Y(:,14,k,n)-Y(:,15,k,n))*F*1e2,Y(:,6,k,n)*R*T/F,'ko') % tep vs water flux
        hold on
    end 
end 

p = polyfit([Y(:,12,1,1)+Y(:,13,1,1)-Y(:,14,1,1)-Y(:,15,1,1);Y(:,12,1,2)+Y(:,13,1,2)-Y(:,14,1,2)-Y(:,15,1,2);Y(:,12,1,3)+Y(:,13,1,3)-Y(:,14,1,3)-Y(:,15,1,3);...
    Y(:,12,2,1)+Y(:,13,2,1)-Y(:,14,2,1)-Y(:,15,2,1);Y(:,12,2,2)+Y(:,13,2,2)-Y(:,14,2,2)-Y(:,15,2,2);Y(:,12,2,3)+Y(:,13,2,3)-Y(:,14,2,3)-Y(:,15,2,3);...
    Y(:,12,3,1)+Y(:,13,3,1)-Y(:,14,3,1)-Y(:,15,3,1);Y(:,12,3,2)+Y(:,13,3,2)-Y(:,14,3,2)-Y(:,15,3,2);Y(:,12,3,3)+Y(:,13,3,3)-Y(:,14,3,3)-Y(:,15,3,3); ...
    Y(:,12,4,1)+Y(:,13,4,1)-Y(:,14,4,1)-Y(:,15,4,1);Y(:,12,4,2)+Y(:,13,4,2)-Y(:,14,4,2)-Y(:,15,4,2);Y(:,12,4,3)+Y(:,13,4,3)-Y(:,14,4,3)-Y(:,15,4,3);...
    Y(:,12,5,1)+Y(:,13,5,1)-Y(:,14,5,1)-Y(:,15,5,1);Y(:,12,5,2)+Y(:,13,5,2)-Y(:,14,5,2)-Y(:,15,5,2);Y(:,12,5,3)+Y(:,13,5,3)-Y(:,14,5,3)-Y(:,15,5,3);...
    Y(:,12,6,1)+Y(:,13,6,1)-Y(:,14,6,1)-Y(:,15,6,1);Y(:,12,6,2)+Y(:,13,6,2)-Y(:,14,6,2)-Y(:,15,6,2);Y(:,12,6,3)+Y(:,13,6,3)-Y(:,14,6,3)-Y(:,15,6,3);...
    Y(:,12,7,1)+Y(:,13,7,1)-Y(:,14,7,1)-Y(:,15,7,1);Y(:,12,7,2)+Y(:,13,7,2)-Y(:,14,7,2)-Y(:,15,7,2);Y(:,12,7,3)+Y(:,13,7,3)-Y(:,14,7,3)-Y(:,15,7,3);...
    Y(:,12,8,1)+Y(:,13,8,1)-Y(:,14,8,1)-Y(:,15,8,1);Y(:,12,8,2)+Y(:,13,8,2)-Y(:,14,8,2)-Y(:,15,8,2);Y(:,12,8,3)+Y(:,13,8,3)-Y(:,14,8,3)-Y(:,15,8,3); ...
    Y(:,12,9,1)+Y(:,13,9,1)-Y(:,14,9,1)-Y(:,15,9,1);Y(:,12,9,2)+Y(:,13,9,2)-Y(:,14,9,2)-Y(:,15,9,2);Y(:,12,9,3)+Y(:,13,9,3)-Y(:,14,9,3)-Y(:,15,9,3); ...
    Y(:,12,10,1)+Y(:,13,10,1)-Y(:,14,10,1)-Y(:,15,10,1);Y(:,12,10,2)+Y(:,13,10,2)-Y(:,14,10,2)-Y(:,15,10,2);Y(:,12,10,3)+Y(:,13,10,3)-Y(:,14,10,3)-Y(:,15,10,3);...
    Y(:,12,11,1)+Y(:,13,11,1)-Y(:,14,11,1)-Y(:,15,11,1);Y(:,12,11,2)+Y(:,13,11,2)-Y(:,14,11,2)-Y(:,15,11,2);Y(:,12,11,3)+Y(:,13,11,3)-Y(:,14,11,3)-Y(:,15,11,3)]*F*1e2, ...
    [Y(:,6,1,1);Y(:,6,1,2);Y(:,6,1,3);...
    Y(:,6,2,1);Y(:,6,2,2);Y(:,6,2,3);...
    Y(:,6,3,1);Y(:,6,3,2);Y(:,6,3,3); ...
    Y(:,6,4,1);Y(:,6,4,2);Y(:,6,4,3);...
    Y(:,6,5,1);Y(:,6,5,2);Y(:,6,5,3);...
    Y(:,6,6,1);Y(:,6,6,2);Y(:,6,6,3);...
    Y(:,6,7,1);Y(:,6,7,2);Y(:,6,7,3);...
    Y(:,6,8,1);Y(:,6,8,2);Y(:,6,8,3); ...
    Y(:,6,9,1);Y(:,6,9,2);Y(:,6,9,3); ...
    Y(:,6,10,1);Y(:,6,10,2);Y(:,6,10,3);...
    Y(:,6,11,1);Y(:,6,11,2);Y(:,6,11,3)]*R*T/F,2);
plot(sort((Y(:,12,1,1)+Y(:,13,1,1)-Y(:,14,1,1)-Y(:,15,1,1))*F*1e2),polyval(p,sort((Y(:,12,1,1)+Y(:,13,1,1)-Y(:,14,1,1)-Y(:,15,1,1))*F*1e2)),'r-','LineWidth',3)
xlabel('$I_{OC}$ ($\mu$A/cm$^2$)','Interpreter','latex')
ylabel('$V^a$ (V)','Interpreter','latex')
set(gca,'Linewidth',2,'Fontsize',24)
% exportgraphics(gcf,'wf_vs_va.png','Resolution',200)
% print(gcf, 'current_vs_va.png', '-dpng', '-r200');